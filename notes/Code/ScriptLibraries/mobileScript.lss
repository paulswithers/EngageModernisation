'++LotusScript Development Environment:2:5:(Options):0:74
%REM
	Library mobileScript
	Created May 1, 2019 by Paul Withers/Intec
	Description: Comments for Library
%END REM
Option Public
Option Declare


'++LotusScript Development Environment:2:5:(Forward):0:1
Declare Sub exitViewSelectField()
Declare Sub exitCitiesField
Declare Sub exitStatesField

'++LotusScript Development Environment:2:5:(Declarations):0:2

'++LotusScript Development Environment:2:2:exitViewSelectField:5:8
%REM
	Sub exitViewSelectField
	Description: Comments for Sub
%END REM
Sub exitViewSelectField()

	Dim ws As New NotesUIWorkspace
	Dim session As New NotesSession
	Dim db As NotesDatabase
	Dim uidoc As NotesUIDocument
	Dim fieldVal As String, viewName As String
	
	On Error GoTo showErr
	
	Set uidoc = ws.CurrentDocument
	fieldVal = uidoc.FieldGetText("viewSelect")
	Call session.SetEnvironmentVar("xdemo_viewSelect", fieldVal)
	
	If (fieldVal = "By Name") Then
		Call session.SetEnvironmentVar("xdemo_view", "mbContactsName")
		Call ws.ReloadWindow()
	ElseIf (fieldVal = "By Surname") Then
		Call session.SetEnvironmentVar("xdemo_view", "mbContactsSurname")
		Call ws.ReloadWindow()
	ElseIf (fieldVal = "By State") Then
		Call session.SetEnvironmentVar("xdemo_view", "mbContactsState")
		Set db = session.CurrentDatabase
		Call ws.SetTargetFrame("view")
		Call ws.ComposeDocument(db.server, db.filePath, "statesView")
		' Can't reload window here, or you can't leave!
	End If
	Exit Sub
	
showErr:
	MsgBox "Error " & CStr(Err) & " on line " & CStr(Erl) & ": " & Error(Err)
	Exit Sub
End Sub

'++LotusScript Development Environment:2:2:exitCitiesField:5:8
%REM
	Sub exitCitiesField
	Description: Comments for Sub
%END REM
Sub exitCitiesField
	Dim ws As New NotesUIWorkspace
	Dim session As New NotesSession
	Dim uidoc As NotesUIDocument
	Set uidoc = ws.CurrentDocument
	
	On Error GoTo showErr
	
	Dim db As NotesDatabase
	Call session.SetEnvironmentVar("xdemo_city", uidoc.FieldGetText("cities"))
	
	Set db = session.CurrentDatabase
	Call ws.SetTargetFrame("view")
	Call ws.ComposeDocument(db.server, db.filePath, "statesView")
Exit Sub
	
showErr:
	MsgBox "Error " & CStr(Err) & " on line " & CStr(Erl) & ": " & Error(Err)
	Exit sub
End Sub

'++LotusScript Development Environment:2:2:exitStatesField:5:8
%REM
	Sub exitStatesField
	Description: Comments for Sub
%END REM
Sub exitStatesField
	Dim ws As New NotesUIWorkspace
	Dim session As New NotesSession
	Dim uidoc As NotesUIDocument
	Dim doc As NotesDocument
	Dim currValue As String
	
	On Error GoTo showErr
	
	Set uidoc = ws.CurrentDocument
	Dim db As NotesDatabase
	
	Call session.SetEnvironmentVar("xdemo_state", uidoc.Fieldgettext("states"))
	Call session.SetEnvironmentVar("xdemo_city", "All")
	
	Set db = session.CurrentDatabase
	Call ws.SetTargetFrame("view")
	Call ws.ComposeDocument(db.server, db.filePath, "statesView")
Exit Sub
	
showErr:
	MsgBox "Error " & CStr(Err) & " on line " & CStr(Erl) & ": " & Error(Err)
	Exit Sub
End Sub